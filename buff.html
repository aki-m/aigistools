<html lang="ja"><head>
 <META http-equiv="Content-Type" content="text/html;"  charset="UTF-8">
 <META http-equiv="Content-Script-Type" content="text/javascript">
 <META http-equiv="Content-Style-Type" content="text/css">
 <title>千年戦争アイギス　バフ試算表</title>
<!--
　　　　 r＝、､　　　　　　　　 , '⌒ヽ 
　　　　((::::::..ヽヽ　_＿＿　 　{ i:::::::l |　
　　　 　 ﾞ ､::::::l |´　＼＼ ｀ヽj !::::://　
　　　　／　〉:::l |　　　|::::| 　//:::://　
　　 ／匕 ＞(：：)二二二二(：：)く ＼　
　　 {ゞ|／　／　 , 　　j　　i　 ; ヽ ヽ ﾉ 
　 　У　／i　　!/|⌒/| 　 lﾘ⌒j　Y´ 
　　 人/ lr'| 　 仡示ﾉ !__/ r示ﾐ　| 
　 く;;_;;| ,ﾊ_| 　i|弋ソ　　 　弋ｿ.{　!　 まだできてないです
　　/::::| l ! .!,　|ﾄ"" 　　__ 　 "''从j 　 それでも使うです？
　 ,'.::::人ﾄ(从ｲ!心、_　｀´ _ ｡彳)/ 
　 |:::::!　|::::|_人(ｧ 个｀Y〔ｰ､ 　ノ 
　 |:::::|　|:r'ﾞ!.|　｀ .く__,小._,ハ
TIPS
・グループの左端の＋－はクリックで折りたためる
・自己バフONに選択すると対象キャラにあわせるようにユニ条件を自動で反映
・スキルバフONに選択すると対象のキャラがもつ編成･配置バフもON
・選択や数字を変更すると、そのときの呪文が復活の呪文に表示される(予定)
・メモっておいた呪文を入力して[復活]で復元できる
・[復活]はURLを更新しているので、それを保存してもよい。
・というわけで、変更→[復活]→ブクマ とすればメモる必要はない
・このツールのアップデートに対し呪文の互換性がない
・通信していないので、PCにページを保存して、それを使えばOK

・性別バフはトークンのときはかからない。ニエルは女性扱い
-->
 <style>
td{ padding: 3px 0px 2px 0px; }
select,div>span{ font-size:18px; height:100%; margin:0px; }
select{ background-color: yellow; padding:0px 0px 4px 04px; }
.x-b input { font-size:16px;}
table td[is="x-d"] { text-align:center; }
span{ padding:3px 2px 2px 2px; }
#t{
 border:solid 1px blue;
 border-collapse: collapse;
 margin:0px 0px 0px 0px; 
 user-select:none;
 -webkit-user-select:none;
 -moz-user-select:none;
 -ms-user-select:none;
 -o-user-select:none;
 cursor:default;
}
#t td, span{ border: solid 1px #00f;  }
#t tr.bufftype{ border-style:solid; border-color:#00f; border-width: 1px 1px 0px 1px;}
#t tr td{ background:#eff; color:#888; }
#t tr.on td{ background:#bef; color:black; }
#t th,#t tr.t th.csw{ background-color: steelblue; color:white; }
#t tr.f th,#t tr.f td{background-color:honeydew; color:#163; border-bottom:solid 1px blue; }
#t tr.t th{ background-color:#fd6; color:#632; }
#t tr.t td{ font-size:20px; font-weight:600; background-color:#fed; color:black; }
input[type="number"] {  text-align:center;  }
input[type="button"] {
 background-color: #e8ffff;
 border: solid 1px #999;
 border-radius: 5px;
 padding: 0px 8px;
 margin:1px 3px;
 cursor: pointer;
 user-select: none;
 -webkit-user-select: none;
 -moz-user-select: none;
 -ms-user-select: none;
 -o-user-select: none;
}
input.bon { background-color: #ff4; }
input.chk { display:inline; background-color:#90ffcf; }

 </style>
</head>
<body>
<div nowrap><b>千年戦争アイギス　バフ試算表　</b>
<span>復活の呪文<input type="text" size=68 style="font-family:monospace;" id="in19"/><input type="button" id="restoreB" value="復活" id="in20"/></span>
<div style="display:inline-block; font-size:13px;"><a href="meisei.html">...名声値カレンダー</a><br><a href="ikusei2.html">...育成試算表</a></div></div>
<table  id="t">
<tr><th></th><th>キャラ</th><th>アビ・スキル</th><th nowrap >HP</th><th>攻撃</th><th>防御</th><th>魔耐</th><th>射程</th><th>対象</th></tr>
<tr class="f" >
  <th colspan=2 rowspan=3>計算対象ユニ</th>
  <td colspan=9>
   <span class="x-b" id="in05" type="radio"></span>
   <select id="in06"></select>
   <select id="in07"></select>
  </td>
</tr>
<tr class="f" >
  <th nowrap rowspan=2>
    <span class="x-b" id="in08" type="radio"></span>
    <span class="x-b" id="in09" type="radio"></span>
    <br>
    <span class="x-b" id="in10" type="radio"></span>
  </th>
  <td ><input type="number" id="in00" min=0 max=9999 size=4 /></td>
  <td ><input type="number" id="in01" min=0 max=9999 size=4 /></td>
  <td ><input type="number" id="in02" min=0 max=9999 size=4 /></td>
  <td ><input type="number" id="in03" min=0 max=9999 size=4 /></td>
  <td ><input type="number" id="in04" min=0 max=9999 size=4 /></td>
  <td rowspan=2></td>
</tr>
<tr class="f" ><td is="x-d" id="out00"></td><td is="x-d" id="out01"></td><td is="x-d" id="out02"></td><td is="x-d" id="out03"></td><td is="x-d" id="out04"></td></tr>
<tr class="f" ><th colspan=3 rowspan=2> ダンサー</th><td rowspan=2></td><td ><input type="number" id="in11" min=0 max=9999 size=4 /></td><td ><input type="number" id="in12" min=0 max=9999 size=4 /></td><td rowspan=2></td><td rowspan=2></td><td rowspan=2></td></tr>
<tr class="f" ><td is="x-d" id="out05"></td><td is="x-d" id="out06"></td></tr>
<tr class="f" ><th colspan=3 rowspan=2>アンナ</th><td rowspan=2></td><td ><input type="number" id="in13" min=0 max=9999 size=4 /></td><td ><input type="number" id="in14" min=0 max=9999 size=4 /></td><td rowspan=2></td><td rowspan=2></td><td rowspan=2>[王子]</td></tr>
<tr class="f" ><td is="x-d" id="out07"></td><td is="x-d" id="out08"></td></tr>
<tr class="t"><th class="csw">■</th><th nowrap colspan=2>バフ後</th><td is="x-d" id="out10"></td><td is="x-d" id="out11"></td><td is="x-d" id="out12"></td><td is="x-d" id="out13"></td><td is="x-d" id="out14"></td><td></td></tr>
</table>


<script> 
  var inobj=[null]; /* <=復活の呪文などで使用 */
  var outobj=[null];
  var t=document.getElementById("t");
  var gview=[];
  var gname=[];
  var bgno=[];
  var bview=[];
  var bname=[];
  var bon=[];
  var bval=[];
  var bchar=[];
  var bchkf=[];
  var bsetf=[];
  var bskil=[];
  (function(){
    var lbl=[ /*<=ボタンなど*/
        [ ["鉄","銅","銀","金","青","白","黒"] ]
       ,[ ["王子・皇帝","ソルジャー","ヘビーアーマー","ワルキューレ","ローグ","プリンセス系","バンデッド","竜兵・竜戦士","侍","忍者","天馬騎士","ダークファイター","アベンジャー","モンク","前衛軍師","魔法剣士","堕天使","くぐつ使い","セーラー","天孤","神官戦士","メイジアーマー","竜騎士","ボウライダー","メイド","ヴァンパイアロード","ソードマスター","ロイヤルガード","仙人・仙猿","魔人","戦の精霊","ダークストーカー","ぬらりひょん","重装砲兵","鬼","インペリアルナイト","天狗","鍛冶師","剣闘士","キョンシー","雷神","モンスターブレーカー"]
         ,["政務官","アーチャー","メイジ","ヒーラー","ウィッチ","パイレーツ","ドラゴンシャーマン","ヴァンパイアハンター","シャーマン","ビショップ","後衛軍師","陰陽師","召喚士","風水士","砲術士","ダンサー","ネクロマンサー","クロノウィッチ","ドルイド","アルケミスト","レンジャー","シーフ","呪術師","魔物使い","ダークプリースト","エンチャンター","マーチャント","フェンリルシャーマン","モンスターハンター","デモンサモナー","エレメンタラー","猫又","道化師"]
         ,["スケルトン","マーセナリー","魔獣","式鬼","インプ・デーモン","ゴーレム","スチームタンク","化け猫","大ガマ","ケットシー","ジャック Ｏ ランタン","霧分身","火エレメント","土エレメント","風エレメント","水エレメント","闇エレメント","トラバサミ","ミミック","砲撃ポイント"]
         ,[ "生命の木","避禍予見の鏡影","プリズムミラー","芸術家の逸品"] ]
       ,[ ["属性なし","人間","竜人","エルフ(ハーフ・ダーク含む)","ドワーフ","獣人","妖怪","デーモン","アンデッド","オーク","ゴブリン","他(仙人・仙猿・精霊)"] ]
       ,[ ["近接","遠距離"] ]
       ,[ ["女","男","無"] ]
       ,[ ["他","帝国","パルス","砂漠"] ]
      ];
    var addG=function( in_gname ){
      var i;
      for( i=0 ; i<gname.length && in_gname != gname[i] ; i++ ) ;
      if( i >= gname.length){
        gname[i] = in_gname;
        gview[i] = t.insertRow(-1);
        gview[i].innerHTML="<th class='csw'>－</th><th colspan=2 id='h01'>"+gname[i]+"</th><th></th><th></th><th></th><th></th><th></th><th></th>";
        gview[i].className="bufftype";
        //gview[i].setAttribute("grp",i);
        gview[i].id="g"+i;
      }
      return i;
    };
    var addB=function( in_gno,  in_name , in_skill , in_v , in_cn , in_chkf , in_setf ){
      var i,j,k,l,n,m;
      i=bname.length;
      bon  [i] = 0;
      bgno [i] = in_gno;
      bname[i] = in_name;
      bval [i] = in_v;
      bchar[i] = in_cn;
      if(in_skill) bskil[i] = in_skill;
      if(in_chkf ) bskil[i] = in_chkf;
      if(in_setf ) bskil[i] = in_setf;

      bview[i] = t.insertRow(-1);
      bview[i].classname="buff";
      //bview[i].setAttribute("grp",i);
      bview[i].id="b"+i;
      bview[i].insertCell(0).outerHTML="<th nowrap></th>";
      l="<td nowrap>";
      for( j=0 ; j < in_cn.length ; j++){
        if( j ) l += "<br>";
        l += in_cn[j];
      }
      bview[i].insertCell(1).outerHTML=l+"</td>" ;
      bview[i].insertCell(2).outerHTML="<td nowrap>"+ in_name+"</td>";
      for( n=0 ; n<5 ; n++ ){
        l = bview[i].insertCell(n+3);
        l.style["textAlign"]="center";
        if( in_v[n] > 10000 /*<-％と絶対値の敷居*/ ) l.innerText = "+"+((in_v[n]-(in_v[n]%10000))/10000.0);
        else if( in_v[n] > 100 /*<-加算と乗算の敷居*/ ) l.innerText = "×"+(in_v[n]/100.0);
        else if( in_v[n] < 0 ) l.innerText = in_v[n]+"％"; 
        else if( in_v[n]    ) l.innerText = "+"+in_v[n]+"％"; 
      }

      l = bview[i].insertCell(n+3);
      if( ! /.*自己/.test(gname[in_gno]) ){
        for( k=0 ; in_chkf && k <  in_chkf.length ; k++ ){
          n=in_chkf[k];
          if( k == 4 ) l.innerHTML += "<br>";
          if( n == "60  1 010" ){ l.innerText += "[王子]"; continue; }
          if( n == "60  1 011" ){ l.innerText += "[皇帝]"; continue; }
          if( n == "45  1 000" ){ l.innerText += "[カグヤ]"; continue; }
          if( n == "XXXXXX00X" ){ l.innerText += "[近接女性]"; continue; }
          if( n == "XXXXXX01X" ){ l.innerText += "[近接男性]"; continue; }
          m=n.substr(0,1); if( m != "X"   &&                                n.substr(1,8) == "XXXXXXXX" ){ l.innerText += "["+lbl[0][0][m/1]+"]"; continue; }
          m=n.substr(1,3); if( m != "XXX" && n.substr(0,1) == "X"        && n.substr(4,5) == "XXXXX"    ){ l.innerText += "["+lbl[1][(m-(m%100))/100][m%100]+"]"; continue; }
          m=n.substr(4,2); if( m != "XX"  && n.substr(0,4) == "XXXX"     && n.substr(6,3) == "XXX"      ){ l.innerText += "["+lbl[2][0][m/1]+"]"; continue; }
          m=n.substr(6,1); if( m != "X"   && n.substr(0,6) == "XXXXXX"   && n.substr(7,2) == "XX"       ){ l.innerText += "["+lbl[3][0][m/1]+"]"; continue; }
          m=n.substr(7,1); if( m != "X"   && n.substr(0,7) == "XXXXXXX"  && n.substr(8,1) == "X"        ){ l.innerText += "["+lbl[4][0][m/1]+"]"; continue; }
          m=n.substr(8,1); if( m != "X"   && n.substr(0,8) == "XXXXXXXX"                                ){ l.innerText += "["+lbl[5][0][m/1]+"]"; continue; }
          if( ! /.*X/.test(n) ) l.innerText += "[自身？]";
        }
      }
    };
    var r,i,j,k;
    for(i=0;i<=20;i++) inobj [i]=document.getElementById( ((i<10)? "in0": "in")+i );
    for(i=0;i<=14;i++) outobj[i]=document.getElementById( ((i<10)?"out0":"out")+i );
    for( i=0 ; i< lbl.length ; i++ ) for( j=0 ; j<lbl[i].length ; j++ ) for( k=0 ; k<lbl[i][j].length ; k++ ){
      n=document.createElement( (i==1 || i==2 )?"OPTION":"INPUT" );
      n.value=(i==1 || i==2)?(k+j*100):lbl[i][j][k];
      if(i==1 || i==2){ n.innerText=lbl[i][j][k]; inobj[5+i].add(n); }else{ n.setAttribute("num",k); n.type="button"; inobj[5+i].appendChild(n); }
    }

    r=addG("編成バフ(全体)");
    addB(r,"全員の最大ＨＰアップ【中】"   ,0,[10, 0, 0,0, 0],["アデル"         ]);
    addB(r,"全員の最大ＨＰアップ【大】"   ,0,[14, 0, 0,0, 0],["アイシャ"       ]);
    addB(r,"全員の攻撃力アップ【小】"     ,0,[ 0, 2, 0,0, 0],["アリア"         ]);
    addB(r,"全員の攻撃力アップ【中】"     ,0,[ 0, 5, 0,0, 0],["ウズメ","レオラ"]);
    addB(r,"全員の攻撃力アップ【大】"     ,0,[ 0, 7, 0,0, 0],["キキョウ"       ]);
    addB(r,"全員の防御力アップ【小】"     ,0,[ 0, 0, 2,0, 0],["ケイティ"       ]);
    addB(r,"全員の防御力アップ【中】"     ,0,[ 0, 0, 5,0, 0],["レン"           ]);
    addB(r,"全員の防御力アップ【大】"     ,0,[ 0, 0, 7,0, 0],["イリス"         ]);
    addB(r,"難攻不落の要塞"               ,0,[ 0, 0,17,0, 0],["ルイーズ"       ]);
    addB(r,"舞巫女の守護霊"               ,0,[0,0,0,50000,0],["ミヤビ"         ]);

    r=addG("編成バフ(近・遠,性別限定)");
    addB(r,"打ち出の小槌"                 ,0,[ 0, 5, 0, 0, 0],["カグラ"      ],["XXXXXX0XX"]);
    addB(r,"剣聖武芸指南"                 ,0,[ 0,10, 0, 0, 0],["ジークリンデ"],["XXXXXX0XX"]);
    addB(r,"六丈銭の赤備え"               ,0,[ 5, 5, 5, 0, 0],["マツリ"      ],["XXXXXX0XX"]);
    addB(r,"魔法防壁"                     ,0,[0,0,0,100000,0],["グレース"    ],["XXXXXX0XX"]);
    addB(r,"トレジャーハント【魔水晶】"   ,0,[ 0,0,0,50000,0],["モニカ"      ],["XXXXXX1XX"]);
    addB(r,"マスタースミス＋武器職人【男専用】",0,[0,5,5,0,0],["ゴルドー"    ],["XXXXXX01X"]);
    addB(r,"マスタースミス＋鍛冶神の祝福" ,0,[ 0, 5, 5, 0, 0],["ティニー"    ],["XXXXXX00X"]);
    addB(r,"防御力魔法耐性アップ【男】"   ,0,[ 0,0,5,50000,0],["オスカー"    ],["XXXXXXX1X"]);
    addB(r,"トレジャーハント【酒】"       ,0,[15, 0, 0, 0, 0],["ロベルト"    ],["XXXXXXX1X"]);

    r=addG("編成バフ(職種,種族限定)");
      /* 職種 */
    addB(r,"撤退支援"                     ,0,[20, 0, 0, 0, 0],["アルティア"  ],["X1  XXXXX"]);
    addB(r,"シールドブースト"             ,0,[ 0,0,5,50000,0],["リーゼロッテ"],["X1  XXXXX","X2  XXXXX"]);
    addB(r,"ヘビーアーマーの防御力アップ" ,0,[ 0, 0, 7, 0, 0],["ベルニス"    ],["X2  XXXXX"]);
    addB(r,"ヘビーアーマーの攻撃力アップ" ,0,[ 0, 7, 0, 0, 0],["ミランダ"    ],["X2  XXXXX"]);
    addB(r,"ワルキューレの攻撃力アップ"   ,0,[ 0, 7, 0, 0, 0],["ダリア"      ],["X3  XXXXX"]);
    addB(r,"英雄の守り手"                 ,0,[15, 0, 0, 0, 0],["レシア"      ],["X3  XXXXX","X10 XXXXX","X22 XXXXX"]);
    addB(r,"トレジャーハント【宝石】"     ,0,[ 0,15, 0, 0, 0],["キュテリ"    ],["X4  XXXXX","X121XXXXX"]);
    addB(r,"山賊の攻撃力アップ"           ,0,[ 0, 7, 0, 0, 0],["コンラッド"  ],["X6  XXXXX"]);
    addB(r,"山賊の最大ＨＰアップ"         ,0,[15, 0, 0, 0, 0],["イメリア"    ],["X6  XXXXX"]);
    addB(r,"サムライの防御力アップ"       ,0,[ 0, 0, 7, 0, 0],["コジュウロウ"],["X8  XXXXX"]);
    addB(r,"サムライ、忍者の攻撃力アップ" ,0,[ 0, 7, 0, 0, 0],["シズカ"      ],["X8  XXXXX","X9  XXXXX"]);
    addB(r,"ペガサスライダー攻撃力アップ" ,0,[ 0, 7, 0, 0, 0],["イザベル"    ],["X10 XXXXX"]);
    addB(r,"モンクの攻撃力アップ"         ,0,[ 0, 7, 0, 0, 0],["リン"        ],["X13 XXXXX"]);
    addB(r,"魔法剣士の攻撃力アップ"       ,0,[ 0, 7, 0, 0, 0],["サビーネ"    ],["X15 XXXXX"]);
    addB(r,"天使長の号令"                 ,0,[ 0, 5, 0, 0, 0],["ミルノ"      ],["X16 XXXXX"]);
    addB(r,"戦う機甲技師"                 ,0,[ 0, 5, 0, 0, 0],["ボリス"      ],["X17 XXXXX"]);
    addB(r,"ゴッドブレス"                 ,0,[0,0,0,0,100000],["エクス"      ],["X20 XXXXX","X103XXXXX","X113XXXXX","X124XXXXX"]);
    addB(r,"強化魔導鎧"                   ,0,[ 5, 5, 5, 0, 0],["パルフィ"    ],["X21 XXXXX"]);
    addB(r,"馬上弓術指南"                 ,0,[ 0, 5, 0, 0, 0],["カティナ"    ],["X23 XXXXX"]);
    addB(r,"侍女の忠誠（術士）"           ,0,[ 0, 7, 0, 0, 0],["シャーリー"  ],["X109XXXXX","X130XXXXX"]); /*ビショップ、エレメンタラー*/
    addB(r,"侍女の献身(無法者)"           ,0,[ 7, 0, 0, 0, 0],["アイリーン"  ],["X6  XXXXX"]); /*山賊*/
    addB(r,"侍女の献身(無法者)"           ,0,[ 0, 5, 0, 0, 0],["アイリーン"  ],["X105XXXXX"]); /*海賊*/
    addB(r,"侍女の献身(王子・皇帝・姫)"   ,0,[10,10,10, 0, 0],["セーラ"      ],["60  1 010","60  1 011","X5  XXXXX"]); /*王子/皇帝/全プリンセス系*/
    addB(r,"勝利の槍"                     ,0,[ 0, 5, 5, 0, 0],["アリシア"    ],["X27 XXXXX","X3  XXXXX","X10 XXXXX","X22 XXXXX"]); /*ロイガ、ワル、ペガ、ドラゲ*/
    addB(r,"帝国騎士の鼓舞"               ,0,[ 0, 7, 0, 0, 0],["アリーセ"    ],["X35 XXXXX"]); /*インペ*/
    addB(r,"前衛軍師の最大HPアップ"       ,0,[15, 0, 0, 0, 0],["シャオ"      ],["X14 XXXXX"]);
    addB(r,"アーチャーの攻撃力アップ"     ,0,[ 0, 7, 0, 0, 0],["スピカ"      ],["X101XXXXX"]);
    addB(r,"神業の手ほどき"               ,0,[ 0,10, 0, 0, 0],["アーシェラ"  ],["X101XXXXX","X120XXXXX","X23 XXXXX"]); /*弓、レンジャイ、ボーライダ*/
    addB(r,"メイジの攻撃力アップ"         ,0,[ 0, 7, 0, 0, 0],["ガラニア"    ],["X102XXXXX"]);
    addB(r,"魔力調律"                     ,0,[ 0,10, 0, 0, 0],["エステル"    ],["X102XXXXX","X109XXXXX","X21 XXXXX"]);/*ﾒｲｼﾞ､ﾋﾞｼｮ､ﾒｲｼﾞｱｰﾏｰ*/
    addB(r,"ヒーラーの攻撃力アップ"       ,0,[ 0, 7, 0, 0, 0],["ユーノ"      ],["X103XXXXX"]);
    addB(r,"ウィッチの攻撃力アップ"       ,0,[ 0, 7, 0, 0, 0],["ベリンダ"    ],["X104XXXXX"]);
    addB(r,"海賊の攻撃力アップ"           ,0,[ 0, 7, 0, 0, 0],["アネリア"    ],["X105XXXXX"]);
    addB(r,"海賊の火砲戦術"               ,0,[0,0,0,0,100000],["ミネルバ"    ],["X105XXXXX","X114XXXXX","X126XXXXX"]); /*海賊、砲術、商人*/
    addB(r,"聖矢の祝福"                   ,0,[ 0, 7, 0, 0, 0],["ルマリア"    ],["X107XXXXX"]);
    addB(r,"祖霊の追い風"                 ,0,[0,0,0,0,100000],["スー"        ],["X101XXXXX","X107XXXXX","X120XXXXX"]); /*弓、VH、レンジャイ*/
    addB(r,"大地の気脈"                   ,0,[ 0, 5, 0, 0, 0],["ピピン"      ],["X113XXXXX"]);
    addB(r,"大司教の威厳"                 ,0,[ 0,13, 0, 0, 0],["ベルゼッタ"  ],["X103XXXXX","X124XXXXX"]);
    addB(r,"悪魔召喚士の秘儀"             ,0,[ 0,0,0,50000,0],["リヴル"      ],["X129XXXXX"]);
    addB(r,"マスタースミス＋ソードスミス" ,0,[ 0, 5, 5, 0, 0],["サンディー"  ],["X1  XXXXX","X8  XXXXX","X11 XXXXX","X14 XXXXX","X26 XXXXX","X35 XXXXX","60  1 010"]); /*ソードスミス*/
      /* 両方 */
    addB(r,"竜巫女の祝福"                 ,0,[ 5, 0, 5, 0, 0],["エキドナ"    ],["XXXX2 XXX","X22 XXXXX"]); /*竜族*/
    addB(r,"ドラゴンフォース"             ,0,[ 0, 7, 0, 0, 0],["ルビナス"    ],["XXXX2 XXX","X22 XXXXX"]); /*竜族*/
      /* 種族 */
    addB(r,"妖精姫の祝福"                 ,0,[15, 5, 0, 0, 0],["オリヴィエ"  ],["XXXX3 XXX","XXXX4 XXX"]); /*エルフ、ドワーフ*/
    addB(r,"要請の堅陣"                   ,0,[ 0,0,5,50000,0],["ププル"      ],["XXXX3 XXX","XXXX4 XXX"]); /*エルフ、ドワーフ*/
    addB(r,"侍女の忠誠（亜人）"           ,0,[ 0,10, 0, 0, 0],["リーナ"      ],["XXXX3 XXX","XXXX4 XXX"]); /*エルフ、ドワーフ*/
    addB(r,"侍女の忠誠（亜人）"           ,0,[15, 0, 0, 0, 0],["リーナ"      ],["XXXX9 XXX"]); /*オーク */
    addB(r,"白面金毛九尾の狐"             ,0,[0,10,10,100000,0],["カヨウ"    ],["XXXX6 XXX"]); /*妖怪*/
    addB(r,"影の総大将"                   ,0,[ 5, 5, 5, 0, 0],["カスミ"      ],["XXXX6 XXX"]); /*妖怪*/
    addB(r,"ヒロイックオーク"             ,0,[ 0,10,10, 0, 0],["アナトリア"  ],["XXXX9 XXX","XXXX10XXX"]); /*オーク、ゴブリン*/
    addB(r,"屍体活性"                     ,0,[ 5, 5, 5, 0, 0],["レイメイ"    ],["XXXX8 XXX"]); /*不死者*/
    addB(r,"侍女の献身（カグヤ）"         ,0,[ 0,10,10, 0, 0],["ヒカゲ"      ],["45  1 000"]); /*カグヤ*/

    r=addG("編成バフ(所属,レアリティ限定)");
      /* 所属 */
    addB(r,"隠された神器の後継者"         ,0,[ 5, 5, 5, 0, 0],["アンジェリーネ"    ],["XXXXXXXX1"]);
    addB(r,"帝国治癒士の務め"             ,0,[ 5,0,0,50000,0],["エリアス"          ],["XXXXXXXX1"]);
    addB(r,"帝国軍師の号令"               ,0,[ 0, 0, 7, 0, 0],["レオナ"            ],["XXXXXXXX1"]);
    addB(r,"ヤシャスィーン"               ,0,[ 0, 5, 5, 0, 0],["アルスラーン"      ],["XXXXXXXX2"]);
    addB(r,"戦意高揚【砂漠】"             ,0,[ 0,10, 0, 0, 0],["王子(砂漠)"        ],["XXXXXXXX3"]);
      /* レアリティ */
    addB(r,"夏祭りの小さな思い出"         ,0,[15, 0,15, 0, 0],["浴衣の兵長フィリス"],["0XXXXXXXX","1XXXXXXXX"]);
    addB(r,"夏祭りの思い出"               ,0,[20, 0,20, 0, 0],["浴衣の兵長フィリス"],["0XXXXXXXX","1XXXXXXXX"]);
    addB(r,"シルバーフルチャージ"         ,0,[ 5, 0, 0, 0, 0],["ロゼット"          ],["2XXXXXXXX"]);
    addB(r,"騎士姫の導き"                 ,0,[ 5, 5, 5, 0, 0],["シェリー"          ],["2XXXXXXXX"]);

    r=addG("配置バフ(全体)");
    addB(r,"戦意高揚"                     ,0,[ 0,20,20, 0, 0],["王子(アイギス神器)","王子(ケラウノス神器)"]);
    addB(r,"戦意高揚【砂漠】"             ,0,[ 0,20,20, 0, 0],["王子(砂漠)"        ]);
    addB(r,"戦意高揚【小】"               ,0,[ 0,10,10, 0, 0],["王子【幼少】"      ]);
    addB(r,"幸せの記憶"                   ,0,[ 0, 5, 5, 0, 0],["レーヴ"            ]);
    addB(r,"魔眼の加護"                   ,0,[ 0, 0, 5, 5, 0],["バロウス"          ]);
    addB(r,"聖銀竜の加護"                 ,0,[ 0, 0, 5, 5, 0],["ティファ"          ]);
    addB(r,"職：コマンダー"               ,0,[ 0,3,3,30000,0],["アルティア","ジェローム","ケイティ","浴衣の兵長フィリス"]);

    r=addG("配置バフ(近・遠,性別限定)");
    addB(r,"酒池肉林(対女性)"             ,0,[ 0,10, 0, 0, 0],["堕姫"              ],["XXXXXXX0X"]);
    addB(r,"酒池肉林(対男性)"             ,0,[ 0,-10,0, 0, 0],["堕姫"              ],["XXXXXXX1X"]);
    addB(r,"超鎧狩り"                     ,0,[ 0,10, 0, 0, 0],["アマンダ"          ],["XXXXXX0XX"]);
    addB(r,"スピリットブーストⅡ"         ,0,[ 0,13,13, 0, 0],["シンシア"          ],["XXXXXX0XX"]);
    addB(r,"ブーストミサイル"             ,0,[ 0,10, 0, 0, 0],["ソシエ"            ],["XXXXXX1XX"]);
    addB(r,"マスタースミス＋武器職人【男専用】",0,[0,15,15,0,0],["ゴルドー"        ],["XXXXXX01X"]);
    addB(r,"マスタースミス＋鍛冶神の祝福" ,0,[ 0,15,15, 0, 0],["ティニー"          ],["XXXXXX00X"]);

    r=addG("配置バフ(職種,種族限定)");
      /* 職種 */
    addB(r,"火力支援指揮"                 ,0,[ 0,10, 0,0, 0] ,["ヘレナ"          ],["X114XXXXX","X105XXXXX","X126XXXXX"]);
    addB(r,"マスタースミス＋ソードスミス" ,0,[ 0, 5, 5,0, 0] ,["サンディー"      ],["X1  XXXXX","X8  XXXXX","X11 XXXXX","X14 XXXXX","X26 XXXXX","X35 XXXXX","60  1 010"]); /*ソードスミス*/
    addB(r,"魔戦団長の号令"               ,0,[ 0,10,10,0, 0] ,["イングリッド"    ],["X15 XXXXX","X21 XXXXX","X102XXXXX","X109XXXXX"]);
    addB(r,"一等航海士の指揮"             ,0,[ 0,10, 0,0, 0] ,["アメリ"          ],["X18 XXXXX","X105XXXXX"]); /*水兵、海賊*/
    addB(r,"聖典の導き"                   ,0,[ 0,10, 0,0, 0] ,["フェルミ"        ],["X20 XXXXX","X103XXXXX"]); /*神官,ヒラ*/
    addB(r,"逆撃の防陣"                   ,0,[ 0, 5,10,0, 0] ,["ミレイユ"        ],["X2  XXXXX","X27 XXXXX"]); /*鎧,ロイガ*/
    addB(r,"迫撃の号令"                   ,0,[ 0,10,10,0, 0] ,["エルミラ"        ],["X33 XXXXX","X35 XXXXX"]); /*重装砲兵,インペ*/
    addB(r,"未来の天才召喚士"             ,0,[ 0,10, 0,0, 0] ,["リノ"            ],["X112XXXXX"]);
    addB(r,"ハイネクロマンシー"           ,0,[ 0,15, 0,0, 0] ,["メトゥス"        ],["X116XXXXX","XXXX8 XXX","X200XXXXX"]); /*ネクロ、不死者、骨*/
    addB(r,"森と動物の守り人"             ,0,[ 0,10, 0,0, 0] ,["メープル"        ],["X3  XXXXX","X23 XXXXX","X118XXXXX","X120XXXXX"]); /*馬、ボーライダー、ドルイド、レンジャー*/
    addB(r,"罠威力向上"                   ,0,[ 0,10, 0,0, 0] ,["アイーダ"        ],["X217XXXXX"]); /*トラップ*/
    addB(r,"魔獣調教II"                   ,0,[ 0,0,100,0, 0] ,["モルテナ"        ],["X202XXXXX"]); /*犬*/
    addB(r,"大商人の才覚"                 ,0,[ 0,50, 0,0, 0] ,["ディエーラ"      ],["X201XXXXX"]); /*マーセナリー*/
    addB(r,"デモンエンハンス"             ,0,[ 0,100,0,0, 0] ,["ラピス"          ],["X204XXXXX"]); /*インプ*/
    addB(r,"上級風霊使役"                 ,0,[0,0,0,100000,0],["ハルカ"          ],["X214XXXXX"]); /*風エレ*/
      /* 両方 */
    addB(r,"ドラゴンスケイル"             ,0,[ 0, 0,10,0, 0] ,["イグニス"        ],["XXXX2 XXX","X22 XXXXX"]);
    addB(r,"ロードオブドラゴン"           ,0,[ 0,15, 0,0, 0] ,["エルドラ"        ],["XXXX2 XXX","X22 XXXXX"]);
      /* 種族 */
    addB(r,"闇妖精の女王"                 ,0,[ 0,10, 0,0, 0] ,["ドロテア"        ],["XXXX3 XXX","XXXX4 XXX"]); /*エルフ、ドワーフ*/
    addB(r,"魔神団長の号令"               ,0,[ 0,10, 0,0, 0] ,["メフィスト"      ],["XXXX7 XXX","XXXX9 XXX","XXXX10XXX"]); /*デーモン、オーク、ゴブ*/
    addB(r,"龍の天祐?+Aさん(+1人)"        ,0,[ 0, 5, 5,0, 0] ,["ハクノカミ"      ],["61062 100"]);
    addB(r,"龍の天祐?+Bさん(+1人)"        ,0,[ 0, 5, 5,0, 0] ,["ハクノカミ"      ],["61062 100"]);
    addB(r,"龍の天祐?+Cさん(+1人)"        ,0,[ 0, 5, 5,0, 0] ,["ハクノカミ"      ],["61062 100"]);
    addB(r,"龍の天祐?+Dさん(+1人)"        ,0,[ 0, 5, 5,0, 0] ,["ハクノカミ"      ],["61062 100"]);
    addB(r,"龍の天祐?+Eさん(+1人)"        ,0,[ 0, 5, 5,0, 0] ,["ハクノカミ"      ],["61062 100"]);
    addB(r,"龍の天祐?+Fさん(+1人)"        ,0,[ 0, 5, 5,0, 0] ,["ハクノカミ"      ],["61062 100"]);
    addB(r,"龍の天祐?+Gさん(+1人)"        ,0,[ 0, 5, 5,0, 0] ,["ハクノカミ"      ],["61062 100"]);
    addB(r,"龍の天祐?+Hさん(+1人)"        ,0,[ 0, 5, 5,0, 0] ,["ハクノカミ"      ],["61062 100"]);
    addB(r,"龍の天祐?+Iさん(+1人)"        ,0,[ 0, 5, 5,0, 0] ,["ハクノカミ"      ],["61062 100"]);
    addB(r,"龍の天祐?+Jさん(+1人)"        ,0,[ 0, 5, 5,0, 0] ,["ハクノカミ"      ],["61062 100"]);

    r=addG("配置バフ(自己・確立,動的)");
    addB(r,"魔剣覚醒？"                   ,0,[ 0,80, 0,0, 0] ,["シビラ"          ] ,["65  1 000"],"65  1 000" );
    addB(r,"ホーリーエンチャント？"       ,0,[ 0,80, 0,0, 0] ,["コーネリア"      ] ,["65  1 000"],"611 1 000" );
    addB(r,"大鑑巨砲"                     ,0,[ 0,90, 0,0, 0] ,["イブキ"          ] ,["618 1 000"],"618 1 000" );
    addB(r,"マルダーンフ・マルダーン"     ,0,[ 0,20, 0,0, 0] ,["ダリューン"      ] ,["627 1 012"],"627 1 012" );
    addB(r,"必殺の一撃"                   ,0,[ 0,90, 0,0, 0] ,["ユリアン","ドロシー" ]);

    r=addG("スキルバフ(自己)");
    addB(r,"英雄の片鱗"                 ,1,[300,300,300,0,0],["王子【幼少】"       ],["60  1 010"],"60  1 010");
    addB(r,"アイギスの神器"             ,1,[ 0,300,300,0,0],["王子(アイギス神器)"  ],["60  1 010"],"60  1 010");
    addB(r,"ケラウノスの神器"           ,1,[ 0,200,  0,0,0],["王子(ケラウノス神器)"],["60  1 010"],"60  1 010");
    addB(r,"獅子刀スルフィカール"       ,1,[ 0,150,  0,0,0],["王子(砂漠)"          ],["60  1 010"],"60  1 010");
    addB(r,"援軍要請・撃滅"             ,5,[ 0,200,  0,0,0],["アルティア"          ],["61  1 000"],"61  1 000");
    addB(r,"怪力爆砕鉄球"               ,5,[ 0,200,200,0,0],["ディーナ"            ],["62  1 000"],"62  1 000");
    addB(r,"大震撃"                     ,5,[ 0,  0,140,0,0],["ディーネ"            ],["62  1 000"],"62  1 000");
    addB(r,"勝利のルーン(1回目)"        ,5,[ 0,180,180,0,0],["クリッサ"            ],["63  1 000"],"63  1 000");
    addB(r,"勝利のルーン(2回目)"        ,5,[ 0,240,240,0,0],["クリッサ"            ],["63  1 000"],"63  1 000");
    addB(r,"勝利のルーン(最終)"         ,5,[ 0,300,300,0,0],["クリッサ"            ],["63  1 000"],"63  1 000");
    addB(r,"死の旋風"                   ,5,[ 0,190,  0,0,0],["ベルナ"              ],["64  1 000"],"64  1 000");
    addB(r,"魔剣アンサラー"             ,5,[ 0,200,  0,0,0],["シビラ"              ],["65  1 000"],"65  1 000");
    addB(r,"聖剣アルタキエラ"           ,5,[ 0,130,  0,0,0],["オリヴィエ"          ],["65  3 000"],"65  3 000");
    addB(r,"金剛鎌ハルパー"             ,5,[ 0,  0,180,0,0],["アンジェリーネ"      ],["65  1 001"],"65  1 001");
    addB(r,"吸血剣フルンティング(1回目)",5,[ 0,140,140,0,0],["シルヴィア"          ],["65  8 000"],"65  8 000");
    addB(r,"吸血剣フルンティング(2回目)",5,[ 0,220,220,0,0],["シルヴィア"          ],["65  8 000"],"65  8 000");
    addB(r,"吸血剣フルンティング(最終)" ,5,[ 0,300,300,0,0],["シルヴィア"          ],["65  8 000"],"65  8 000");
    addB(r,"神剣ティルフィング"         ,5,[ 0,150,150,0,0],["純白の花嫁カルマ"    ],["65  8 000"],"65  8 000");
    addB(r,"死剣ミュルグレス"           ,5,[ 0,200,200,0,0],["ミサ"                ],["65  0 000"],"65  0 000");
    addB(r,"死剣ミュルグレス(対人間)"   ,5,[ 0,300,300,0,0],["ミサ"                ],["65  0 000"],"65  0 000");
    addB(r,"大山賊時代"                 ,5,[ 0,200,  0,0,0],["アマンダ"            ],["66  1 000"],"66  1 000");
    addB(r,"回復Ⅳ"                     ,5,[ 0,200,  0,0,0],["ドラニア"            ],["67  2 010"],"67  2 010");
    addB(r,"輝剣クラウ・ソラス"         ,5,[ 0,200,  0,0,0],["アーニャ"            ],["67  2 000"],"67  2 000");
    addB(r,"魔剣バルムンク"             ,5,[ 0,170,  0,0,0],["エルドラ"            ],["67  2 000"],"67  2 000");
    addB(r,"鬼切の初太刀"               ,5,[ 0,230,230,0,0],["ヒバリ"              ],["68  1 000"],"68  1 000");
    addB(r,"鬼切の初太刀(対妖怪)"       ,5,[ 0,345,345,0,0],["ヒバリ"              ],["68  1 000"],"68  1 000");
    addB(r,"鬼切"                       ,5,[ 0,200,200,0,0],["ヒバリ"              ],["68  1 000"],"68  1 000");
    addB(r,"鬼切(対妖怪)"               ,5,[ 0,260,260,0,0],["ヒバリ"              ],["68  1 000"],"68  1 000");
    addB(r,"忍法乱れ手裏剣"             ,5,[ 0,  0,0,0,130],["サキ"                ],["69  1 000"],"69  1 000");
    addB(r,"秘伝の丸薬"                 ,5,[160,160,160,0,0],["ナギ"               ],["69  1 000"],"69  1 000");
    addB(r,"燃命の秘薬"                 ,5,[200,200,200,300000,0],["ナギ"          ],["69  1 000"],"69  1 000");
    addB(r,"撃滅の天翼"                 ,5,[ 0,150,-20, 0,0],["エスタ"             ],["610 1 000"],"610 1 000");
    addB(r,"聖騎士の守護"               ,5,[0,130,250,250,0],["コーネリア"         ],["611 1 000"],"611 1 000");
    addB(r,"暗黒オーラ斬り"             ,5,[0,250,  0,  0,0],["暗黒騎士"           ],["611 0 010"],"611 0 010");
    addB(r,"硬気功"                     ,5,[0,  0,200,  0,0],["アリス"             ],["613 1 000"],"613 1 000");
    addB(r,"剛力活丹功(1回目)"          ,5,[130,200,0,  0,0],["アリス"             ],["613 1 000"],"613 1 000");
    addB(r,"剛力活丹功(2回目)"          ,5,[160,220,0,  0,0],["アリス"             ],["613 1 000"],"613 1 000");
    addB(r,"剛力活丹功(3回目)"          ,5,[190,250,0,  0,0],["アリス"             ],["613 1 000"],"613 1 000");
    addB(r,"夢想転身(最終)"             ,5,[0,300,200,  0,0],["アリス"             ],["613 1 000"],"613 1 000");
    addB(r,"疾風迅雷"                   ,5,[0,180,  0,  0,0],["マツリ"             ],["614 1 000"],"614 1 000");
    addB(r,"ギガバリアブレイク"         ,5,[0,170,  0,0,140],["イングリッド"       ],["615 1 000"],"615 1 000");
    addB(r,"堕天使封印解除"             ,5,[0,200,200,0,200],["ソフィー"           ],["616 1 000"],"616 1 000");
    addB(r,"拡散ギガブラスター"         ,5,[0,170,-50,0,200],["ウェンディ"         ],["617 1 000"],"617 1 000");
    addB(r,"一斉射撃"                   ,5,[  0,170,  0,0,0],["イブキ"             ],["618 1 000"],"618 1 000");
    addB(r,"大炎上"                     ,5,[  0,200,200,0,0],["カヨウ"             ],["619 6 000"],"619 6 000");
    addB(r,"一尾の解放"                 ,5,[120,120,120,0,0],["キュウビ"           ],["619 6 001"],"619 6 001");
    addB(r,"三尾の解放"                 ,5,[190,190,190,0,0],["キュウビ"           ],["619 6 001"],"619 6 001");
    addB(r,"五尾の解放"                 ,5,[260,260,260,0,0],["キュウビ"           ],["619 6 001"],"619 6 001");
    addB(r,"七尾の解放"                 ,5,[330,330,330,0,0],["キュウビ"           ],["619 6 001"],"619 6 001");
    addB(r,"九尾の解放"                 ,5,[400,400,330,0,0],["キュウビ"           ],["619 6 001"],"619 6 001");
    addB(r,"リミッターカット"           ,5,[  0,270,270,0,0],["グレース"           ],["621 1 000"],"621 1 000");
    addB(r,"スターバースト"             ,5,[  0,300,0,0,140],["シルセス"           ],["621 1 000"],"621 1 000");
    addB(r,"エターナルブレーク"         ,5,[  0,  0,0,0,140],["シルセス"           ],["621 1 000"],"621 1 000");
    addB(r,"聖銀竜の牙槍"               ,5,[  0,170,  0,0,0],["ティファ"           ],["622 1 000"],"622 1 000");
    addB(r,"聖銀竜の鱗(+牙槍)"          ,5,[  0,170,170,0,0],["ティファ"           ],["622 1 000"],"622 1 000");
    addB(r,"聖銀竜の血(+牙槍,鱗)"       ,5,[170,170,170,0,0],["ティファ"           ],["622 1 000"],"622 1 000");
    addB(r,"宮廷槍斧術・攻守の型"       ,5,[  0,190,  0,0,0],["セーラ"             ],["624 1 000"],"624 1 000");
    addB(r,"秘奥義　不動七連絶刀"       ,5,[  0,400,  0,0,0],["ジークリンデ"       ],["626 1 001"],"626 1 001");
    addB(r,"聖槍ロンゴミニアド"         ,5,[180,  0,180,0,0],["ミレイユ"           ],["627 1 000"],"627 1 000");
    addB(r,"五万騎全殲滅の構え"         ,5,[  0,150,  0,0,0],["ダリューン"         ],["627 1 012"],"627 1 012");
    addB(r,"火尖槍・焔玉"               ,5,[  0,200,200,0,0],["ナタク"             ],["628 11000"],"628 11000");
    addB(r,"魔人調伏の一刻"             ,5,[  0,300,  0,0,0],["ラクシャーサ"       ],["628 7 000"],"629 7 000");
    addB(r,"鬼神の刻"                   ,5,[  0,140,  0,0,0],["ラクシャーサ"       ],["628 7 000"],"629 7 000");
    addB(r,"ヴァルプルギスの夜"         ,5,[  0,130,  0,0,0],["メフィスト"         ],["628 7 001"],"629 7 001");
    addB(r,"タフネスチャージ"           ,5,[170,  0,  0,0,0],["シンシア"           ],["628 11001"],"629 11001");
    addB(r,"聖なる覚醒(+タフネスチャージ)",5,[170,200,200,0,0],["シンシア"         ],["628 11001"],"629 11001");
    addB(r,"鬼首落とし"                 ,5,[  0,300,  0,0,0],["シノ"               ],["632 6 000"],"632 8 000");
    addB(r,"総大将の長ドス"             ,5,[  0,170,  0,0,0],["シノ"               ],["632 6 000"],"632 8 000");
    addB(r,"シュツルムカノーネ"         ,5,[  0,120,  0,0,0],["エルミラ"           ],["633 1 001"],"633 1 001");
    addB(r,"羅生門"                     ,5,[  0,150,150,0,0],["鬼刃姫"             ],["634 6 000"],"634 8 000");
    addB(r,"不滅の闘魂"                 ,5,[  0,200,  0,0,0],["アナトリア"         ],["638 9 000"],"638 9 000");
    addB(r,"甲破り砲撃戦モード"         ,5,[  0,180,  0,0,0],["テンマ"             ],["641 1 000"],"641 1 000");
    addB(r,"アダマスの神器"             ,5,[  0,200,  0,0,0],["白の皇帝"           ],["60  1 011"],"60  1 011");
    addB(r,"罪弓ミストルティン"         ,5,[  0,130,  0,0,0],["アーシェラ"         ],["61011 100"],"61011 100");
    addB(r,"魔杖レヴァンテイン"         ,5,[  0,200,  0,0,0],["エステル"           ],["61021 100"],"61021 100");
    addB(r,"聖女の結界"                 ,5,[  0,140,  0,0,0],["イリス"             ],["61031 100"],"61031 100");
    addB(r,"真癒しの至宝"               ,5,[  0,  0,0,0,160],["リアナ"             ],["61031 100"],"61031 100");
    addB(r,"コキュートス"               ,5,[  0,170,  0,0,0],["デスピア"           ],["61041 100"],"61041 100");
    addB(r,"魔弾タスラム(1回目)"        ,5,[  0,280,  0,0,0],["ミネルバ"           ],["61051 100"],"61051 100");
    addB(r,"魔弾タスラム(2回目)"        ,5,[  0,320,  0,0,0],["ミネルバ"           ],["61051 100"],"61051 100");
    addB(r,"魔弾タスラム(3回目)"        ,5,[  0,360,  0,0,0],["ミネルバ"           ],["61051 100"],"61051 100");
    addB(r,"魔弾タスラム(4回目)"        ,5,[  0,400,  0,0,0],["ミネルバ"           ],["61051 100"],"61051 100");
    addB(r,"魔弾タスラム(最終)"         ,5,[  0,440,  0,0,0],["ミネルバ"           ],["61051 100"],"61051 100");
    addB(r,"古代龍の逆鱗"               ,5,[  0,200,  0,0,0],["ハクノカミ"         ],["61062 100"],"61062 100");
    addB(r,"スピリットスナイプ"         ,5,[  0,200,0,0,160],["スー"               ],["61071 100"],"61071 100");
    addB(r,"二重詠唱"                   ,5,[  0,-20,  0,0,0],["エターナー"         ],["61091 100"],"61091 100");
    addB(r,"超天落岩の計"               ,5,[  0,300,0,0,300],["アイシャ"           ],["61101 100"],"61101 100");
    addB(r,"破邪滅殺の結界"             ,5,[  0,700,0,0,170],["ミコト"             ],["61111 100"],"61111 100");
    addB(r,"刻詠の宿業"                 ,5,[  0,  0,0,0,180],["リンネ"             ],["61131 100"],"61131 100");
    addB(r,"暗黒超重力弾"               ,5,[  0,200,0,0,  0],["フレデリカ"         ],["61141 100"],"61141 100");
    addB(r,"魅惑の舞"                   ,5,[  0,  0,0,0,120],["ミヤビ"             ],["61151 100"],"61151 100");
    addB(r,"アニメイトデッド"           ,5,[  0,300,0,0,120],["メトゥス"           ],["61161 100"],"61161 100");
    addB(r,"秘法　魔導加速の理"         ,5,[  0,  0,0,0,120],["トワ"               ],["61171 100"],"61171 100");
    addB(r,"樹縛の秘術"                 ,5,[  0,170,  0,0,0],["フィオレ"           ],["61181 100"],"61181 100");
    addB(r,"樹林繁栄の唄"               ,5,[  0,150,0,0,  0],["フィオレ"           ],["61181 100"],"61181 100");
    addB(r,"ハイパーアシッドボム"       ,5,[  0,250,0,0,  0],["マキナ"             ],["61191 100"],"61191 100");
    addB(r,"フェイタルダガー"           ,5,[  0,300,0,0,  0],["サバル"             ],["61215 100"],"61215 100");
    addB(r,"蛇神の供催"                 ,5,[-50,150,0,0,  0],["オロチヒメ"         ],["61221 100"],"61221 100");
    addB(r,"魔獣炎操"                   ,5,[  0,200,0,0,  0],["モルテナ"           ],["61231 100"],"61231 100");
    addB(r,"魔獣獄炎操"                 ,5,[  0,150,0,0,  0],["モルテナ"           ],["61231 100"],"61231 100");
    addB(r,"暗黒神降臨の儀"             ,5,[  0,-10,0,0,  0],["ドロテア"           ],["61233 100"],"61233 100");
    addB(r,"聖魔殲滅弾ラグナレク"       ,5,[  0,250,0,0,  0],["ソシエ"             ],["61281 100"],"61281 100");
    addB(r,"聖魔殲滅弾ラグナレク(対悪魔,天使)",5,[0,400,0,0,0],["ソシエ"           ],["61281 100"],"61281 100");
    addB(r,"デモニックフィールド"       ,5,[  0,  0,0,0,120],["ラピス"             ],["61297 100"],"61297 100");
    addB(r,"聖女の叫び声"               ,5,[  0,200,200,0,0],["ゼノビア"           ],["51  1 000"],"51  1 000");
    addB(r,"援軍要請・攻防"             ,5,[  0,150,150,0,0],["リーゼロッテ"       ],["51  1 000"],"51  1 000");
    addB(r,"不可侵の神盾"               ,5,[  0,0,200,200,0],["ジェイク"           ],["51  1 010"],"51  1 010");
    addB(r,"フルガード"                 ,5,[  0,0,300,300,0],["ジェリウス"         ],["52  1 010"],"52  1 010");
    addB(r,"鬼神力"                     ,5,[  0,300,  0,0,0],["モミジ"             ],["58  1 000"],"58  1 000");
    addB(r,"クイックショットⅡ"         ,5,[  0,190,  0,0,0],["オスカー","ほか"    ],["XXXXXX1XX"],"XXXXXX1XX");
    addB(r,"鉄壁"                       ,5,[  0,0,300,300,0],["ザラーム"           ],["312 1 012"],"312 1 012");
    addB(r,"アヌビスの守護"             ,5,[  0,0,500,  0,0],["ザラーム"           ],["312 1 012"],"312 1 012");
    addB(r,"木々の目覚め"               ,5,[  0,140,  0,0,0],["ローリエ"           ],["31181 100"],"31181 100");
/*                                                                                                
  "魔剣覚醒"
 "アデル":[  "攻撃力強化Ⅳ"     ],
*/

    r=addG("スキルバフ(射程内)");
    addB(r,"士気高揚"                     ,0,[0,112,112,0,0] ,["王子"          ]);
    addB(r,"士気高揚＋英雄の末裔"         ,0,[0,115,115,0,0] ,["王子"          ]);
    addB(r,"士気高揚＋勇者"               ,0,[0,117,117,0,0] ,["王子"          ]);
    addB(r,"士気高揚＋救世主"             ,0,[0,119,119,0,0] ,["王子"          ]);
    addB(r,"士気高揚＋大英雄"             ,0,[0,121,121,0,0] ,["王子"          ]);
    addB(r,"死霊強化"                     ,0,[0,300,300,0,0] ,["メメント"      ],["X200XXXXX"]);/*対トークン*/
    addB(r,"アンデッドマーチ"             ,0,[0,300,300,0,0] ,["メメント"      ],["X200XXXXX"]);/*対トークン*/
    addB(r,"ウォークライ"                 ,0,[0,120,  0,0,0] ,["ブランシュ"    ]);
    addB(r,"デモニックフィールド"         ,0,[0,150,  0,0,0] ,["ラピス"        ]);
    addB(r,"デモニックテリトリー"         ,0,[0,150,  0,0,0] ,["ラピス"        ]);
    addB(r,"破魔聖樹の輝光"               ,0,[0,140,  0,0,0] ,["破魔の聖樹"    ]);
    addB(r,"バトルプロテクション"         ,0,[0,  0,150,0,0] ,["エクス"        ]);
    addB(r,"ゴッドプロテクション"         ,0,[0,  0,200,0,0] ,["エクス"        ]);
    addB(r,"プロテクションI"              ,0,[0,  0,150,0,0] ,["イリス"        ]);
    addB(r,"プロテクションII"             ,0,[0,  0,200,0,0] ,["イリス"        ]);
    addB(r,"聖女の結界"                   ,0,[0,  0,250,0,0] ,["イリス"        ]);
    addB(r,"ダークプロテクション"         ,0,[0,  0,170,0,0] ,["ベルディナート"]);
    addB(r,"隊商防御陣"                   ,0,[0,  0,120,0,0] ,["ディエーラ"    ]);
    addB(r,"守護聖樹の輝光"               ,0,[0,  0,200,0,0] ,["守護の聖樹"    ]);

    r=addG("スキルバフ(全体)");
    addB(r,"英雄の片鱗"                   ,0,[0,120,120,0,0] ,["王子【幼少】"]);
    addB(r,"火竜の炎陣"                   ,0,[0,120,  0,0,0] ,["イグニス"    ]);
    addB(r,"烈火の陣"                     ,0,[0,120,  0,0,0] ,["ウズメ","イグニス"]);
    addB(r,"猛火の陣(1回目)"              ,0,[0,120,  0,0,0] ,["ウズメ"      ]);
    addB(r,"猛火の陣(2回目)"              ,0,[0,125,  0,0,0] ,["ウズメ"      ]);
    addB(r,"猛火の陣(最終)"               ,0,[0,130,  0,0,0] ,["ウズメ"      ]);
    addB(r,"猛将の鼓舞"                   ,0,[0,110,  0,0,0] ,["シュウカ"    ]);
    addB(r,"ブリッツクリーク"             ,0,[0,115,115,0,0] ,["レオラ"      ]);
    addB(r,"シュツルムアングリフ"         ,0,[0,125,125,0,0] ,["レオラ"      ]);
    addB(r,"鉄壁の陣"                     ,0,[0,  0,120,0,0] ,["レン"        ]);
    addB(r,"金城の陣(1回目)"              ,0,[0,  0,120,0,0] ,["レン"        ]);
    addB(r,"金城の陣(2回目)"              ,0,[0,  0,125,0,0] ,["レン"        ]);
    addB(r,"金城の陣(最終)"               ,0,[0,  0,130,0,0] ,["レン"        ]);
    addB(r,"性質変換の秘術"               ,0,[0,  0,125,0,0] ,["シャルル"    ]);

    r=addG("スキルバフ(系統)");
    addB(r,"大山賊時代"                   ,0,[200,  0,0,0,0] ,["アマンダ"      ],["X6  XXXXX"]);
    addB(r,"基本戦術・陣地防御"           ,0,[0,  0,120,0,0] ,["ヘレナ"        ]);
    addB(r,"基本戦術・反転攻勢"           ,0,[0,120,  0,0,0] ,["ヘレナ"        ]);
    addB(r,"応用戦術・堅守強攻(対近接)"   ,0,[0,  0,125,0,0] ,["ヘレナ"        ],["XXXXXX0XX"]); /*近接*/
    addB(r,"応用戦術・堅守強攻(対遠距離)" ,0,[0,125,  0,0,0] ,["ヘレナ"        ],["XXXXXX1XX"]); /*遠距離*/
    addB(r,"一斉射撃"                     ,0,[0,130,  0,0,0] ,["イブキ"        ],["XXXXXX1XX"]); /*遠距離*/
    addB(r,"妖魔のおもてなし"             ,0,[0,140,140,0,0] ,["リーナ"        ],["XXXX3 XXX","XXXX4 XXX","XXXX5 XXX","XXXX9 XXX"]); /*エルフ・ドワーフ/ゴブリン/オーク/獣人*/
    addB(r,"宮廷槍斧術・守の型"           ,0,[0,  0,180,0,0] ,["セーラ"        ],["60  1 010","60  1 011","X5  XXXXX"]); /*王子/皇帝/全プリンセス系*/
    addB(r,"宮廷槍斧術・攻守の型"         ,0,[0,150,150,0,0] ,["セーラ"        ],["60  1 010","60  1 011","X5  XXXXX"]); /*王子/皇帝/全プリンセス系*/
    addB(r,"槍連撃(熱砂の連携戦術)"       ,0,[0,115,115,0,0] ,["ネフティ"      ],["XXXXXXXX3"]); /*砂漠*/
    addB(r,"太陽の槍撃(熱砂の連携戦術)"   ,0,[0,115,115,0,0] ,["ネフティ"      ],["XXXXXXXX3"]); /*砂漠*/
    addB(r,"闇の進撃"                     ,0,[0,  0,150,0,0] ,["メフィスト"    ],["XXXX7 XXX","XXXX9 XXX","XXXX5 XXX","XXXX10XXX"]); /*デーモン/オーク/ゴブリン*/
    addB(r,"総大将の長ドス・影打"         ,0,[0,130,130,0,0] ,["カスミ"        ],["XXXX6 XXX"]); /*妖怪*/
    addB(r,"不滅の妖怪仁義"               ,0,[0,110,110,0,0] ,["カスミ"        ],["XXXX6 XXX"]); /*妖怪*/
    addB(r,"武具鍛錬＋武器職人【男専用】" ,0,[0,120,120,0,0] ,["ゴルドー"      ],["XXXXXX01X"]);
    addB(r,"武具鍛錬・極致"               ,0,[130,120,120,0,0],["ゴルドー"     ],["XXXXXX01X"]);
    addB(r,"武具鍛錬＋ソードスミス"       ,0,[0,120,120,0,0] ,["サンディー"    ],["X1  XXXXX","X8  XXXXX","X11 XXXXX","X14 XXXXX","X26 XXXXX","X35 XXXXX","60  1 010"]); /*ソードスミス*/
    addB(r,"ヴァルカンの鎚"               ,0,[0,120,120,0,0] ,["サンディー"    ],["X1  XXXXX","X8  XXXXX","X11 XXXXX","X14 XXXXX","X26 XXXXX","X35 XXXXX","60  1 010"]); /*ソードスミス＝ソル、サムライ、ダークファイター、前軍師、ソードマスター、インペ、王子*/
    addB(r,"フォージ・アーマー"           ,0,[0,120,130,0,0] ,["ティニー"      ],["XXXXXX00X"]); /*武具女*/
    addB(r,"フォージ・ウェポン"           ,0,[0,130,120,0,0] ,["ティニー"      ],["XXXXXX00X"]); /*武具女*/
    addB(r,"堅鱗の癒やし"                 ,0,[0,  0,140,0,0] ,["エキドナ"      ],["XXXX2 XXX","X22 XXXXX"]); /*竜族*/
    addB(r,"鋭牙の火炎"                   ,0,[0,140,  0,0,0] ,["ルビナス"      ],["XXXX2 XXX","X22 XXXXX"]); /*竜族*/
    addB(r,"木々の目覚め"                 ,0,[0,140,  0,0,0] ,["ローリエ"      ],["X300XXXXX"]); /*ドルイドトークン*/
    addB(r,"樹林繁栄の唄"                 ,0,[0,150,  0,0,0] ,["フィオレ"      ],["X300XXXXX"]); /*ドルイドトークン*/
    addB(r,"魔獣炎操"                     ,0,[0,200,  0,0,0] ,["モルテナ"      ],["X202XXXXX"]); /*魔物トークン*/
    addB(r,"魔獣獄炎操"                   ,0,[0,150,  0,0,0] ,["モルテナ"      ],["X202XXXXX"]); /*魔物トークン*/
    addB(r,"帝国の勇者＋アダマスの神器"   ,0,[0,125,125,0, 0] ,["白の皇帝"        ],["XXXXXXXX1"]);

    r=addG("スキルバフ(レア指定)");
    addB(r,"ダモクレスの剣"               ,0,[0,120,120,0,0] ,["ロゼット"        ],["2XXXXXXXX"]);

    r=addG("ステ加算値バフ(ダンサー)");
    addB(r,"魅惑の舞"                     ,0,[0, 700, 700,0,0],["ミヤビ"         ]);
    addB(r,"不可侵の神事舞"               ,0,[0,1200,1200,0,0],["ミヤビ"         ]);
    addB(r,"ラストダンス"                 ,0,[0,1000,1000,0,0],["ビビアン"       ]);
    addB(r,"アンコールダンス"             ,0,[0,1000,1000,0,0],["ビビアン"       ]);
    addB(r,"オートステップ"               ,0,[0,1000,1000,0,0],["ビビアン"       ]);
    addB(r,"パッションステップ"           ,0,[0,1000,1000,0,0],["ワルツ"         ]);
    addB(r,"エンドレスワルツ"             ,0,[0, 300, 300,0,0],["ワルツ"         ]);
    addB(r,"癒しの舞"                     ,0,[0,1000,1000,0,0],["ハナ"           ]);
    addB(r,"ソウルステップ"               ,0,[0,1000,1000,0,0],["ハナ","マーニー"]);
    addB(r,"エスカレートステップ(1回目)"  ,0,[0,1000,1000,0,0],["マーニー"       ]);
    addB(r,"エスカレートステップ(2回目)"  ,0,[0,1200,1200,0,0],["マーニー"       ]);
    addB(r,"エスカレートステップ(最終)"   ,0,[0,1300,1300,0,0],["マーニー"       ]);

    r=addG("ステ加算値バフ(政務官)");
    addB(r,"全力サポート"                 ,0,[0,1000,1000,0,0],["アンナ","アンナ(支給服)","アンナ(軍服)"]);
    addB(r,"究極サポート"                 ,0,[0,1200,1200,0,0],["アンナ(水着)"]);
  })();

  var saveword={
    charmap:"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-.",
    addS:function(n,v,l){
      n[0]=n[0]+(v<<n[1]);
      n[1]=n[1]+l;
      while( n[1] >= 6 ){
        n[2] += saveword.charmap.substr(n[0]&63,1);
        n[0] >>= 6;
        n[1] -= 6;
      }
    },
    getS:function(n,l){
      var r;
      while( n[1] < l && n[2].length > 0 ){
        n[0] += saveword.charmap.indexOf(n[2].substr(0,1)) << n[1];
        n[1] +=6;
        n[2] = n[2].substr(1,n[2].length-1);
      }
      r=n[0]&((1<<l)-1);
      n[0] >>= l;
      n[1] -= l;
      return r;
    },
    backupstr:function(){
      var w=[0,0,""]; /*<=*/
      var i,j;
      saveword.addS(w, 0,12); /*12bit:version */
      saveword.addS(w, getV(inobj[  0]) ,14); /*14bit:HP */
      saveword.addS(w, getV(inobj[  1]) ,14); /*14bit:攻撃*/
      saveword.addS(w, getV(inobj[  2]) ,14); /*14bit:防御*/
      saveword.addS(w, getV(inobj[  3]) ,14); /*14bit:魔耐*/
      saveword.addS(w, getV(inobj[  4]) ,14); /*14bit:射程*/
      saveword.addS(w, getV(inobj[  5]) , 3); /* 3bit:レア*/
      saveword.addS(w, getV(inobj[  6]) , 9); /* 9bit:職*/
      saveword.addS(w, getV(inobj[  7]) , 5); /*5bit:属性*/
      saveword.addS(w, getV(inobj[  8]) , 1); /*1bit:近・遠*/
      saveword.addS(w, getV(inobj[  9]) , 2); /*6bit:性別 */;
      saveword.addS(w, getV(inobj[ 10]) , 2); /*2bit:所属 */
      saveword.addS(w, getV(inobj[ 11]) ,14); /*14bit:ダンサー攻撃 */
      saveword.addS(w, getV(inobj[ 12]) ,14); /*14bit:ダンサー防御 */
      saveword.addS(w, getV(inobj[ 13]) ,14); /*14bit:アンナ攻撃 */
      saveword.addS(w, getV(inobj[ 14]) ,14); /*14bit:アンナ防御 */
      for( i=0 ; i < bon.length ; i++ ){
        saveword.addS(w, bon[i]  ,1); /*1:選択・非選択 */
      }
      if( w[1] > 0 ) w[2] += saveword.charmap.substr( w[0]&63,1 ); /*末尾の6BITに満たない端数 */
      for(i=j=0 ; i<w[2].length ; i++ ) j=j^saveword.charmap.indexOf(w[2].substr(i,1)); /* CHECK-SUM */
      w[2] += saveword.charmap.substr( j,1 );
      return w[2];
    },
    restorestr:function(s){
      var i,j,k;
      var w=[0,0,s];
      k = saveword.getS(w, 12);
      setV(inobj[  0] , saveword.getS(w,14));
      setV(inobj[  1] , saveword.getS(w,14));
      setV(inobj[  2] , saveword.getS(w,14));
      setV(inobj[  3] , saveword.getS(w,14));
      setV(inobj[  4] , saveword.getS(w,14));
      setV(inobj[  5] , saveword.getS(w, 3));
      setV(inobj[  6] , saveword.getS(w, 9));
      setV(inobj[  7] , saveword.getS(w, 5));
      setV(inobj[  8] , saveword.getS(w, 1));
      setV(inobj[  9] , saveword.getS(w, 2));
      setV(inobj[ 10] , saveword.getS(w, 2));
      setV(inobj[ 11] , saveword.getS(w,14));
      setV(inobj[ 12] , saveword.getS(w,14));
      setV(inobj[ 13] , saveword.getS(w,14));
      setV(inobj[ 14] , saveword.getS(w,14));
      for( i=0 ; i<bon.length ; i++ ){
        bon[i] = saveword.getS(w,1);
      }
    },
    checkstr:function(str){
      var i,j;
      for(i=j=0 ; i+1 < str.length ; i++ ){
        j=j^saveword.charmap.indexOf(str.substr(i,1));
      }
      return ( j == saveword.charmap.indexOf(str.substr(i,1)) );
    }
 };

 function findB(in_gname , in_bname){
    for( r=bname.length-1 ; r >= 0 && in_bname != bname[r] && in_gname != gname[bgno[r]] ; r-- );
    return r;
 }
 function cnvN(v){
    if( (""+v).length <= 3 ) return v;
    if( (""+v).substr(0,(""+v).length-3) == "-" ) return v;
    return cnvN((""+v).substr(0,(""+v).length-3))+","+(""+v).substr((""+v).length-3,3);
 }
 function getV(o){
    if( o.getAttribute("is") == "x-d" ) return o.getAttribute("value")/1;
    switch( o.className ){
      case "x-b":
      case "x-l":
      case "x-d": return o.getAttribute("value")/1; break;
      default: return o.value; break;
    }
  }
  function setV(o,n){
    if( o.getAttribute("is") == "x-d" ){
          o.setAttribute("value",n);
          o.innerHTML=(o.getAttribute("pre")?o.getAttribute("pre"):"")+cnvN(n)+(o.getAttribute("sur")?o.getAttribute("sur"):"");
          return;
    }
    switch( o.className ){
      case "x-b":
          var l=o.children.length;
          if( n >= 2 ) n %= l;
          o.setAttribute("value",n);
          if( l <= 1 ){
            o.children[0].className=(n?"bon":"");
          }else
          if( o.getAttribute("type") != "radio" ){
            o.children[0].value=l[n%l];
          }else{
            var i;
            for( i=0 ; i<l ; i++ ){
              o.children[i].className=(i==(n%l))?"bon":"";
            }
          }
          break;
      case "x-l":
          o.setAttribute("value",n);
          o.innerText=cnvN(n);
          break;
      case "x-d":
          o.setAttribute("value",n);
          o.innerHTML=(o.pre?o.pre:"")+cnvN(n)+(o.sur?o.sur:"");
          break;
      default: o.value=n; break;
    }
  }

 function openRotate(in_id){
   var i,j,grp;
   var cntg0=0; // opened off cnt
   var cntg1=0; // opened on cnt
   var cntg2=0; //opened off
   var cntg3=0; //opened on
   var n=-1;
   if( in_id && in_id.substr(0,1) == "g" ) n=in_id.substr(1)/1;

   for( i=0 ; i < bname.length ; i++ ){
     if( n >=0 && n != bgno[i]) continue; /* <= 指定グループじゃない */
     if( bview[i].style["display"] == "none" ) continue; // closed
     if( bon[i] ) cntg1++; else cntg0++; /* increment */
   }
   for( i=0 ; i < gname.length ; i++ ){
     if( n >=0 && n != i) continue; //指定グループじゃない
     for( j=0 ; j < bname.length ; j++ ){
       if( bgno[j] != i ) continue;
       if( cntg0 ){
         if( bon[j] == 0 ){
           if( bview[j].style["display"] != "none" ) bview[j].style["display"] = "none";
         }else{
           cntg3++;
         }
       }else if( cntg1 ){
         if( bview[j].style["display"] != "none" ) bview[j].style["display"] = "none";
       }else{
         if( bview[j].style["display"] != "table-row" ) bview[j].style["display"] = "table-row";
         if(bon[j] ) cntg3++; else cntg2++;
       }
     }
     gview[i].cells[0].innerText = cntg2?"＋":(cntg3?"÷":"－");
     cntg2=cntg3=0;
   }
 }

 function getFlgStr(){
  return (getV( inobj[ 5] )+" "  ).substr(0,1)
       + (getV( inobj[ 6] )+"   ").substr(0,3)
       + (getV( inobj[ 7] )+"  " ).substr(0,2)
       + (getV( inobj[ 8] )+" "  ).substr(0,1)
       + (getV( inobj[ 9] )+" "  ).substr(0,1)
       + (getV( inobj[10] )+" "  ).substr(0,1);
 }
 function setFlg( str ){
   var l;
   l=str.substr(0,1); if( l != "X"   ) setV( inobj[ 5] , l   );
   l=str.substr(1,3); if( l != "XXX" ) setV( inobj[ 6] , l/1 );
   l=str.substr(4,2); if( l != "XX"  ) setV( inobj[ 7] , l/1 );
   l=str.substr(6,1); if( l != "X"   ) setV( inobj[ 8] , l   );
   l=str.substr(7,1); if( l != "X"   ) setV( inobj[ 9] , l   );
   l=str.substr(8,1); if( l != "X"   ) setV( inobj[10] , l   );
 }
 function chkFlgStr( stat , checker ){
   var i,l;
   for( i=0 ; i < checker.length ; i++ ){
     l=checker[i].substr(0,1); if( l != "X"   && stat.substr(0,1)   != l   ) continue;
     l=checker[i].substr(1,3); if( l != "XXX" && stat.substr(1,3)/1 != l/1 ) continue;
     l=checker[i].substr(4,2); if( l != "XX"  && stat.substr(4,2)   != l/1 ) continue;
     l=checker[i].substr(6,1); if( l != "X"   && stat.substr(6,1)   != l   ) continue;
     l=checker[i].substr(7,1); if( l != "X"   && stat.substr(7,1)   != l   ) continue;
     l=checker[i].substr(8,1); if( l != "X"   && stat.substr(8,1)   != l   ) continue;
     return true;
   }
   return false;
 }

 function onoff( i,k ){
   var l,m;
   if( k ){
     /* "称号が違うものはOFF" */
     if(/^王子/.test(bchar[i][0])) for( l=0 ; l<bname.length ; l++ ){ 
       if( /^王子/.test(bchar[l][0]) ){
         if( /^士気高揚/.test(bname[i]) ) bon[l]=0;
         else
         if( bchar[i][0] != bchar[l][0]
          &&(bchar[i].length <= 1 || bchar[i][0] != bchar[l][1] )
          &&(bchar[l].length <= 1 || bchar[i][1] != bchar[l][0] ) )
            bon[l]=0;
       }
     }
     switch( gname[bgno[i]] ){ 
       case "スキルバフ(自己)":
         if( bchar[i].length == 1 ) for( l=0 ; l<bname.length ; l++ ) if( /^編成バフ/.test(bname[bgno[l]]) || /^配置バフ/.test(gname[bgno[l]]) )
           for( m=0 ; m< bchar[l].length ; m++ ) if( bchar[i][0] == bchar[l][m] ) 
              bon[l]=1; /* <="自己バフから、そのユニの編成・配置バフがあればそちらもON" */
       case "ステ加算値バフ(政務官)":
       case "ステ加算値バフ(ダンサー)":
         /* "１つのみ" */
         for( l=0 ; l<bname.length ; l++ ) if( bgno[l] == bgno[i] ) bon[l]=0;
         break;
       default:
     }
   }
   bon[i] = k?1:0;
   if( bsetf[i] ) setFlg( bsetf[i] );
   doDraw(null);
 }

 function doDraw(ev){
   var i,j,k,l,m,n;
   var v=[0,0,0]; /*値、ダンサーステ、アンナステ*/
   var w;
   var flg = [getFlgStr() ,"51151 100" ,"61001 100" ];
   i=j=k=l=m=n=-1;
   for( m=0 ; m<5 ; m++ ){
     v[0]=v[1]=v[2]=0;
     w= [ [0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]];/*"i-dacer-anna:編成、射程、スキル射程、スキル全体、スキル系統、スキル特殊、スキル自己、ステ加算"*/
     for( i=0 ; i < gname.length ; i++  ){
       for( j=0 ; j < bname.length ; j++ ){
         if( bgno[j] != i ) continue;
         if( bon[j] ){
           if( bview[j].className != "on" ) bview[j].className="on";
           if( ! bchkf[j] ){
             if( /^編成バフ|^配置バフ/.test(gname[i]) ) for(o=0;o<3;o++) v[o] += bval[j][m];
             if( (/^スキルバフ/.test(gname[i]) || gname[i].substr(0,7) == "ステ加算値バフ") ) for(o=0;o<3;o++) if( v[o] < bval[j][m] ) v[o] = bval[j][m];
           }else for( o=0 ; o<3 ; o++ ){
             if( ! chkFlgStr( flg[o] , bchkf[j] ) ) continue;
             if( /^編成バフ|^配置バフ/.test(gname[i]) ) v[o] += bval[j][m];
             if( (/^スキルバフ/.test(gname[i]) || gname[i].substr(0,7) == "ステ加算値バフ") && v[o] < bval[j][m] ) v[o] = bval[j][m];
           }
         }else{
           if( m == 0 ) bview[j].className="";
         }
       }
       if( /^編成バフ/.test(gname[i]) ) for(o=0;o<3;o++) w[o][0] += v[o];
       if( /^配置バフ/.test(gname[i]) ) for(o=0;o<3;o++) w[o][1] += v[o];
       if( /^編成バフ|^配置バフ/.test(gname[i]) ){
           if( (v[0]%10000) != (v[1]%10000) || (v[0]%10000) != (v[2]%10000) ){
             gview[i].cells[2+m].innerText = "＋"+(v[0]%10000)+","+(v[1]%10000)+","+(v[2]%10000)+"％";
           }else{
             gview[i].cells[2+m].innerText=(v[0]%10000)?("＋"+(v[0]%10000)+"％"):"";
           }
           for(o=0;o<3;o++) v[o] =(v[o]-(v[o]%10000))/10000;
           if( v[0] != v[1] || v[0] != v[2] ){
             gview[i].cells[2+m].innerText += "＋"+v[0]+","+v[1]+","+v[2];
           }else if( v[0] ){
             gview[i].cells[2+m].innerText += "＋"+v[0];
           }
         }else if( /^スキルバフ/.test(k) ){
           gview[i].cells[2+m].innerText= (v[0] != v[1] || v[0] != v[2])?("×"+(v[0]?(v[0]/100.0):"-")+","+(v[1]?(v[1]/100.0):"-")+","+(v[2]?(v[2]/100.0):"-")):v[0]?("×"+(v[0]/100.0)):"";
           switch(k){
             case "スキルバフ(自己)":     for(o=0;o<3;o++) if( w[o][2] < v[o] ) w[o][2] = v[o];  break;
             case "スキルバフ(射程内)":   for(o=0;o<3;o++) if( w[o][3] < v[o] ) w[o][3] = v[o];  break;
             case "スキルバフ(全体)":     for(o=0;o<3;o++) if( w[o][4] < v[o] ) w[o][4] = v[o];  break;
             case "スキルバフ(系統)":     for(o=0;o<3;o++) if( w[o][5] < v[o] ) w[o][5] = v[o];  break;
             case "スキルバフ(レア指定)": for(o=0;o<3;o++) if( w[o][6] < v[o] ) w[o][6] = v[o];  break;
           }
         }
         else if( "ステ加算値バフ(ダンサー)" == k && w[1][7] < v[1] ) w[1][7] = v[1];
         else if( "ステ加算値バフ(政務官)"   == k && w[2][7] < v[2] ) w[2][7] = v[2];
         v[0]=v[1]=v[2]=0;
     }
     v=[0,0,0,0,0,0];
     for(o=0;o<3;o++){
       if( m != 1 && m != 2 && o != 0 ) continue;
       if( o != 2 || chkFlgStr( flg[0] , ["60  1 010"] ) ){
         v[o]=getV(inobj[ [m,m+10,m+12][o] ]);
         v[o+3]=0;
         for( i=0 ;  i <= 7 ; i++ ){
           if( (i==7 && o == 0 ) || ! w[o][i] ) continue;
           if( i == 7 ) while( v[o+3]>0 ) { v[o] = (v[o] - (v[o]%10)) /10 ; v[o+3]--; } /* <=整数化 */
           if( i <=1 ){ 
             v[o] = v[o] * (w[o][i]%10000) + v[o]*100 ;
             if(i==0) v[o] = (v[o]-(v[o] % 100))/100; /*<=整数化 */
             else v[o+3]+=2; /*<=整数化しない*/
             if( w[o][i] >= 10000 ){
               k=((w[o][i]-(w[o][i]%10000))/10000);
               for( j=0 ; j<v[o+3] ; j++ ) k *= 10;
               v[o] += k;
             }
           }else{ v[o] *= w[o][i]; v[o+3]+=2; }
           if( v[o+3] > 0 && v[o] >= 10 && v[o] % 10 == 0 ){ v[o] /= 10 ; v[o+3]--; } /*正規化*/
           if( v[o+3] > 0 && v[o] >= 10 && v[o] % 10 == 0 ){ v[o] /= 10 ; v[o+3]--; } /*正規化*/
         }
       }
       if( o ) v[o+3]++; /*ダンサー、アンナは1/10 */
       if( v[o+3] > 0 && v[o] >= 10 && v[o] % 10 == 0 ){ v[o] /= 10 ; v[o+3]--; } /*正規化*/
       if( v[o+3] > 0 && v[o] >= 10 && v[o] % 10 == 0 ){ v[o] /= 10 ; v[o+3]--; } /*正規化*/
       k=""+v[o];
       i=k.length;
       outobj[ [m,m+4,m+6][o] ].innerText= k.substr(0,k.length-v[o+3])+(v[o+3]?"."+k.substr(k.length-v[o+3],8):"") ; /*0,1,2,3,4*/
       while( v[o+3] > 0 ) { v[o] = (v[o] - (v[o]%10)) /10 ; v[o+3]--; } /* <=整数化 */
     }
     setV( outobj[10+m], Math.floor(v[0]/1+v[1]/1+v[2]/1) ); /*10,11,12,13,14*/
   }
   inobj[19].value=saveword.backupstr();
 }

  function doSelect(e){
    switch( e.target.parentNode.tagName.toUpperCase() ){
      case "TR":
        if( e.target.className=="csw" ){
          openRotate( e.target.parentNode.id );
        }else if( e.target.parentNode.id.substr(0,1) == "b" ){
          var i=e.target.parentNode.id.substr(1)/1;
          onoff(i,1-bon[i] );
        }
        break;
      case "SPAN":
        if( e.target.parentNode.className == "x-b" ){
          if( e.target.parentNode.getAttribute("type") == "radio" ){
            setV(e.target.parentNode, e.target.getAttribute("num")/1);
          }else{
            setV(e.target.parentNode , getV(e.target.parentNode)+1);
          }
          doDraw(e);
          break;
        }
        if( e.target.id == "restoreB" ){
          if( getV(inobj[19]).length >= 2 && saveword.checkstr(getV(inobj[19])) ){
             alert("呪文はメンテで互換が無くなるのでページ保存で退避しておくの推奨");
            location.href="?"+getV(inobj[19]);
          }else{
            alert("その呪文は正しくないようだ");
          }
        }
        break;
      default:
    }
  }


  document.body.onload=function(olev){
    var j;
    j=location["search"];
    if( j && j.length > 1 ){
      j=j.substring(j.indexOf("?")+1);
      if( saveword.checkstr(j) ){
        saveword.restorestr(j);
        doDraw(olev);
        return;
      }
      alert("その呪文は正しくないようだ");
    }
    setV(inobj[ 0],2600); /* HP */
    setV(inobj[ 1],540);  /* atk */
    setV(inobj[ 2],700);  /* def */
    setV(inobj[ 3], 20);  /* mgt */
    setV(inobj[ 4],  0);  /* range */
    setV(inobj[11],444);  /* d-atk */
    setV(inobj[12],444);  /* d-def */
    setV(inobj[13],294);  /* a-atk */
    setV(inobj[14],197);  /* a-def */
    onoff( findB("スキルバフ(自己)","アイギスの神器") ,1);
    doDraw(olev);
  };

  document.body.addEventListener( "change", function(ev){
    if( ev.target.id == "in06" ){
      if( getV(ev.target) < 100 ){ /* 近接職 */
        setV( inobj[ 8] , 0 );
      }else if( getV(ev.target) < 200 ){ /* 遠距離職 */
        setV( inobj[ 8] , 1 );
      }else{ /*<="トークン選択時" */
        setV( inobj[ 7] , 0 );
        setV( inobj[ 8] , (getV(ev.target)>=300)?1:0);
        setV( inobj[ 9] , 2 );
        setV( inobj[10] , 0 );
      }
    }
    if( ev.target.id != "in19" ) doDraw(ev);
  });
  var touchObj=null;
  document.body.addEventListener( "touchstart",function(ev){ touchObj=ev.target; } );
  document.body.addEventListener( "touchend",function(ev){ if( touchObj==ev.target){ doSelect(ev);} touchObj=null; } );
  document.body.addEventListener( "click",doSelect );

</script>
</body>
